import{r as c,j as s}from"./index-b7fc291e.js";import{a as g}from"./api-798963ee.js";import{t as M}from"./translations-214f6220.js";const A=({onCharacterCreated:o})=>{const[r,l]=c.useState({name:"",characterClass:"",level:1,abilityScores:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},maxHitPoints:8,armorClass:10,experience:0}),[m,y]=c.useState([]),[h,u]=c.useState(!1),[x,d]=c.useState(""),[p,j]=c.useState("");c.useEffect(()=>{b()},[]),c.useEffect(()=>{f()},[r.abilityScores,r.characterClass]);const b=async()=>{try{const e=await g.getCharacterClasses();y(e),e.length>0&&l(a=>({...a,characterClass:e[0]}))}catch{d("Error al cargar las clases de personaje")}},f=()=>{const e=Math.floor((r.abilityScores.constitution-10)/2),a=Math.floor((r.abilityScores.dexterity-10)/2);let t=8;switch(r.characterClass){case"fighter":case"paladin":case"ranger":t=10;break;case"barbarian":t=12;break;case"bard":case"sorcerer":case"wizard":t=6;break;default:t=8}const n=Math.max(1,t+e),i=10+a;l(N=>({...N,maxHitPoints:n,armorClass:i}))},v=()=>{const e=()=>{const t=Array.from({length:4},()=>Math.floor(Math.random()*6)+1);return t.sort((n,i)=>i-n),t.slice(0,3).reduce((n,i)=>n+i,0)},a={strength:e(),dexterity:e(),constitution:e(),intelligence:e(),wisdom:e(),charisma:e()};l(t=>({...t,abilityScores:a}))},C=(e,a)=>{const t=parseInt(a)||3,n=Math.max(3,Math.min(18,t));l(i=>({...i,abilityScores:{...i.abilityScores,[e]:n}}))},S=async e=>{e.preventDefault(),u(!0),d(""),j("");try{await g.createCharacter(r),j("Â¡Personaje creado exitosamente!"),o==null||o(),l({name:"",characterClass:m[0]||"",level:1,abilityScores:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},maxHitPoints:8,armorClass:10,experience:0})}catch(a){d(a instanceof Error?a.message:"Error al crear el personaje")}finally{u(!1)}};return s.jsxs("div",{className:"card",children:[s.jsx("h2",{children:"Crear Nuevo Personaje"}),x&&s.jsx("div",{className:"error",children:x}),p&&s.jsx("div",{className:"success",children:p}),s.jsxs("form",{onSubmit:S,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"name",children:"Nombre del Personaje"}),s.jsx("input",{type:"text",id:"name",value:r.name,onChange:e=>l(a=>({...a,name:e.target.value})),placeholder:"Ingresa el nombre del personaje",required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"characterClass",children:"Clase de Personaje"}),s.jsx("select",{id:"characterClass",value:r.characterClass,onChange:e=>l(a=>({...a,characterClass:e.target.value})),required:!0,children:m.map(e=>s.jsx("option",{value:e,children:M(e)},e))})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"level",children:"Nivel"}),s.jsx("input",{type:"number",id:"level",min:"1",max:"20",value:r.level,onChange:e=>l(a=>({...a,level:parseInt(e.target.value)||1}))})]}),s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[s.jsx("h3",{children:"Puntuaciones de Habilidad"}),s.jsx("button",{type:"button",className:"button secondary",onClick:v,children:"ðŸŽ² Tirar EstadÃ­sticas"})]}),s.jsx("div",{className:"ability-scores",children:Object.entries(r.abilityScores).map(([e,a])=>s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:e,children:(()=>({strength:"Fue",dexterity:"Des",constitution:"Con",intelligence:"Int",wisdom:"Sab",charisma:"Car"})[e]||e.charAt(0).toUpperCase()+e.slice(1).substring(0,3))()}),s.jsx("input",{type:"number",id:e,min:"3",max:"18",value:a,onChange:t=>C(e,t.target.value)}),s.jsxs("div",{style:{textAlign:"center",fontSize:"0.8rem",opacity:.8},children:[Math.floor((a-10)/2)>=0?"+":"",Math.floor((a-10)/2)]})]},e))})]}),s.jsxs("div",{style:{display:"flex",gap:"20px",marginBottom:"20px"},children:[s.jsxs("div",{className:"form-group",style:{flex:1},children:[s.jsx("label",{children:"Puntos de Vida"}),s.jsx("input",{type:"text",value:r.maxHitPoints,readOnly:!0})]}),s.jsxs("div",{className:"form-group",style:{flex:1},children:[s.jsx("label",{children:"Clase de Armadura"}),s.jsx("input",{type:"text",value:r.armorClass,readOnly:!0})]})]}),s.jsx("button",{type:"submit",className:"button",disabled:h||!r.name.trim(),children:h?"Creando...":"Crear Personaje"})]})]})};export{A as CharacterCreation};
